---
output: pdf_document
---

\begin{titlepage}
\centering
{\includegraphics[width=0.5\textwidth]{LOGOU.png}\par}
\vspace{1cm}
{\bfseries\LARGE Universidad Nacional De Colombia\par}
\vspace{1cm}
{\bfseries\LARGE Trabajo 1 - Hielos\par}
\vspace{1cm}
{\bfseries\LARGE Modelos no lineales\par}
\vfill
{\Large Autores: \par}
{\Large Sofía Cuartas\\ Santiago Carvajal Torres \par}
\vfill
{\Large Entregado a: \par}
{\Large Juan Carlos Correa Morales \par}
\vfill
{\Large 13 de Septiembre 2023 \par}
\end{titlepage}

\newpage
\tableofcontents

\newpage
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,warning = FALSE,message = FALSE)
```

```{r}
library(readxl)
library(kableExtra)
library(ggplot2)
library(magrittr)
library(dplyr)
```

\section{Análisis descriptivo}

```{r lectura}
datos <- read_excel("datos.xlsx")

datos_10ml <- datos[which(datos$Valor_inicial=='10'),]
datos_20ml <- datos[which(datos$Valor_inicial=='20'),]
datos_30ml <- datos[which(datos$Valor_inicial=='30'),]

rbind(head(datos,6)) %>%
  kbl(caption = "Primeros datos en la base de datos") %>%
  kable_styling(full_width = FALSE,latex_options = "HOLD_position") %>%
  kable_classic()

```

\subsection{Gráfico de los datos}

```{r}
colores <- c("10" = "blue", "20" = "red","30" = "yellow")

ggplot(datos, aes(x = Tiempo, y = Volumen_derretido, color = as.factor(Valor_inicial))) +
  geom_point() +
  labs(x = "Tiempo", y = "Volumen derretido") +
  ggtitle("Volumen Derretido en Función del Tiempo") +
  scale_color_manual(name = "Valor Inicial", values = colores) +
  guides(color = guide_legend(override.aes = list(shape = 19))) 
```


\section{Modelos}

\subsection{Modelo logístico}

```{r}
library(GenSA)
modelo <- function(Tiempo, b0, b1) {
  b0 / ((1 - exp(b1 * Tiempo))^(-1))
}

# Definir la función objetivo para la optimización
objetivo <- function(params) {
  b0 <- params[1]
  b1 <- params[2]
  predicciones <- modelo(datos$Tiempo, b0, b1)
  error <- sum((datos$Volumen_derretido - predicciones)^2)
  return(error)
}

# Definir límites para los parámetros
limites <- matrix(c(-100, -100,    # límite inferior para b0 y b1
                    100, 100),  # límite superior para b0 y b1
                  ncol = 2,
                  byrow = TRUE)

# Ejecutar la optimización con GENSA
resultado_optimizacion_logistico <- GenSA(fn = objetivo,
                                lower = limites[1, ],
                                upper = limites[2, ])

# Obtener los valores óptimos de los parámetros
valores_optimos <- resultado_optimizacion_logistico$par

valores_optimos

```

